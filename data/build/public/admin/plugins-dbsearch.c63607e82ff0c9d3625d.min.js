(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[24832],{1983:((r,u,o)=>{"use strict";var g,a;g=[o(29930),o(54222)],a=(function(t,p){var l={},i=0;$(window).on("action:ajaxify.end",function(n,e){e.url==="admin/plugins/dbsearch"&&ajaxify.data.working?c():s()}),l.init=function(){$("#save").on("click",function(){return $.post(config.relative_path+"/api/admin/plugins/dbsearch/save",{_csrf:config.csrf_token,topicLimit:$("#topicLimit").val(),postLimit:$("#postLimit").val(),excludeCategories:$("#exclude-categories").val()},function(n){typeof n=="string"&&p.toggleSaveSuccess($("#save"))}),!1}),$("#reindex").on("click",function(){return bootbox.confirm("Are you sure you want to reindex all content? This might take a while depending on the amount of content. During the operation the forum might slow down.",function(n){n&&socket.emit("admin.plugins.dbsearch.reindex",function(e){if(e)return t.error(e),s();t.success("Started indexing content! This might take a while. You can check the progress on this page."),c()})}),!1}),$("#clear-index").on("click",function(){return bootbox.confirm("Are you sure you want to clear all indices? This might take a while depending on the amount of content. During the operation the forum might slow down.",function(n){n&&socket.emit("admin.plugins.dbsearch.clearIndex",function(e){if(e)return t.error(e),s();t.success("Started clearing index! This might take a while. You can check the progress on this page."),c()})}),!1}),$("#changeLanguage").on("click",function(){var n=$("#indexLanguage").val();t.success('Changing index language to "'+n+'".'),socket.emit("admin.plugins.dbsearch.changeLanguage",n,function(e){if(e)return t.error(e);t.success("Search index language changed!")})})};function c(){$("#topics-indexed").text(0),$("#posts-indexed").text(0),$("#messages-indexed").text(0),$(".progress-bar").css("width","0%").text("0%"),$(".progress").removeClass("invisible"),s(),i=setInterval(f,1e3)}function s(){i&&(clearInterval(i),$(".progress").addClass("invisible"),i=0)}function f(){socket.emit("admin.plugins.dbsearch.checkProgress",function(n,e){if(n)return s(),t.error(n);$(".topic-progress").css("width",e.topicsPercent+"%").text(e.topicsPercent+"%"),$(".post-progress").css("width",e.postsPercent+"%").text(e.postsPercent+"%"),$(".message-progress").css("width",e.messagesPercent+"%").text(e.messagesPercent+"%");var h=parseInt(e.working,10);h?($("#reindex").attr("disabled",!0),$("#clear-index").attr("disabled",!0),$(".progress").removeClass("invisible")):(clearInterval(i),$("#reindex").removeAttr("disabled"),$("#clear-index").removeAttr("disabled"),setTimeout(()=>{$(".progress").addClass("invisible")},2e3),$.getJSON(config.relative_path+"/api/admin/plugins/dbsearch",function(d){$("#topics-indexed").text(d.topicsIndexed),$("#posts-indexed").text(d.postsIndexed),$("#messages-indexed").text(d.messagesIndexed)})),$("#work-in-progress").toggleClass("hidden",!h)})}return l}).apply(u,g),a!==void 0&&(r.exports=a)}),49512:((r,u,o)=>{r.exports=o(1983)})}]);
