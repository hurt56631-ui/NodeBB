"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[1091,15794,21374,25432,34271,49897,57490,63154,99127],{8454:((B,S,o)=>{var C,b;C=[o(24962),o(96352),o(52473),o(17459),o(34342),o(49897),o(33530),o(29930),o(91749),o(30076)],b=(function(P,W,D,I,x,A,R,p,g,k){const M={};let d=!1;M.init=function(i){d=!1,v(),y(i),P.addShareHandlers(ajaxify.data.titleRaw),x.addVoteHandler(),M.updatePostCount(ajaxify.data.postcount)};function v(){document.querySelector('[component="topic"]')&&$('[component="topic"]').on("show.bs.dropdown",'[component="post/tools"]',function(){const a=$(this),s=a.find(".dropdown-menu"),{top:e}=this.getBoundingClientRect();if(a.toggleClass("dropup",e>window.innerHeight/2),s.attr("data-loaded"))return;s.html(k.generatePlaceholderWave([3,5,9,7,10,"divider",10]));const r=a.parents("[data-pid]"),l=r.attr("data-pid"),U=parseInt(r.attr("data-index"),10);socket.emit("posts.loadPostTools",{pid:l},async(t,n)=>{if(t)return p.error(t);n.posts.display_move_tools=n.posts.display_move_tools&&U!==0;const c=await app.parseAndTranslate("partials/topic/post-menu-list",n),h=o(57576);s.attr("data-loaded","true").html(c),new h("[data-clipboard-text]"),g.fire("action:post.tools.load",{element:s})})})}M.toggle=function(i,a){const s=D.get("post","pid",i);s.find('[component="post/quote"], [component="post/bookmark"], [component="post/reply"], [component="post/flag"], [component="user/chat"]').toggleClass("hidden",a),s.find('[component="post/delete"]').toggleClass("hidden",a).parent().attr("hidden",a?"":null),s.find('[component="post/restore"]').toggleClass("hidden",!a).parent().attr("hidden",a?null:""),s.find('[component="post/purge"]').toggleClass("hidden",!a).parent().attr("hidden",a?null:""),M.removeMenu(s)},M.removeMenu=function(i){i.find('[component="post/tools"] .dropdown-menu').removeAttr("data-loaded").html("")},M.updatePostCount=function(i){D.get("topic/post-count").attr("title",i).html(k.humanReadableNumber(i)),W.setCount(i)};function y(i){const a=D.get("topic");q(),a.on("click",'[component="post/quote"]',function(){w($(this),i)}),a.on("click",'[component="post/reply"]',function(){f($(this),i)}),$(".topic").on("click",'[component="topic/reply"]',function(e){e.preventDefault(),f($(this),i)}),$(".topic").on("click",'[component="topic/reply-as-topic"]',function(){I.translate(`[[topic:link-back, ${ajaxify.data.titleRaw}, ${config.relative_path}/topic/${ajaxify.data.slug}]]`,function(e){g.fire("action:composer.topic.new",{cid:ajaxify.data.cid,body:e})})}),a.on("click",'[component="post/bookmark"]',function(){return u($(this),m($(this),"data-pid"))}),a.on("click",'[component="post/upvote"]',function(){return x.toggleVote($(this),".upvoted",1)}),a.on("click",'[component="post/downvote"]',function(){return x.toggleVote($(this),".downvoted",-1)}),a.on("click",'[component="post/vote-count"]',function(){x.showVotes(m($(this),"data-pid"))}),a.on("click",'[component="post/announce-count"]',function(){x.showAnnouncers(m($(this),"data-pid"))}),a.on("click",'[component="post/flag"]',function(){const e=m($(this),"data-pid");o.e(6574).then(function(){var r=[o(6574)];(function(l){l.showFlagModal({type:"post",id:e})}).apply(null,r)}).catch(o.oe)}),a.on("click",'[component="post/already-flagged"]',function(){const e=$(this).data("flag-id");o.e(6574).then(function(){var r=[o(6574)];(function(l){R.confirm("[[flags:modal-confirm-rescind]]",function(U){U&&l.rescind(e)})}).apply(null,r)}).catch(o.oe)}),a.on("click",'[component="post/flagUser"]',function(){const e=m($(this),"data-uid");o.e(6574).then(function(){var r=[o(6574)];(function(l){l.showFlagModal({type:"user",id:e})}).apply(null,r)}).catch(o.oe)}),a.on("click",'[component="post/flagResolve"]',function(){const e=$(this).attr("data-flagId");o.e(6574).then(function(){var r=[o(6574)];(function(l){l.resolve(e)}).apply(null,r)}).catch(o.oe)}),a.on("click",'[component="post/edit"]',function(){const e=$(this),r=parseInt(m(e,"data-timestamp"),10),l=parseInt(ajaxify.data.postEditDuration,10);s(l,r,"post-edit-duration-expired")&&g.fire("action:composer.post.edit",{pid:m(e,"data-pid")})}),config.enablePostHistory&&ajaxify.data.privileges["posts:history"]&&a.on("click",'[component="post/view-history"], [component="post/edit-indicator"]',function(){const e=$(this);o.e(92747).then(function(){var r=[o(92747)];(function(l){l.open(m(e,"data-pid"))}).apply(null,r)}).catch(o.oe)}),a.on("click",'[component="post/delete"]',function(){const e=$(this),r=parseInt(m(e,"data-timestamp"),10),l=parseInt(ajaxify.data.postDeleteDuration,10);s(l,r,"post-delete-duration-expired")&&j($(this))});function s(e,r,l){if(!ajaxify.data.privileges.isAdminOrMod&&e&&Date.now()-r>e*1e3){const U=Math.floor(e/86400),t=Math.floor(e%86400/3600),n=Math.floor(e%86400%3600/60),c=e%86400%3600%60;let h="[[error:"+l+", "+e+"]]";return U?t?h="[[error:"+l+"-days-hours, "+U+", "+t+"]]":h="[[error:"+l+"-days, "+U+"]]":t?n?h="[[error:"+l+"-hours-minutes, "+t+", "+n+"]]":h="[[error:"+l+"-hours, "+t+"]]":n&&(c?h="[[error:"+l+"-minutes-seconds, "+n+", "+c+"]]":h="[[error:"+l+"-minutes, "+n+"]]"),p.error(h),!1}return!0}a.on("click",'[component="post/restore"]',function(){j($(this))}),a.on("click",'[component="post/purge"]',function(){Y($(this))}),a.on("click",'[component="post/move"]',function(){const e=$(this);o.e(90677).then(function(){var r=[o(90677)];(function(l){l.init(e.parents("[data-pid]"))}).apply(null,r)}).catch(o.oe)}),a.on("click",'[component="post/change-owner"]',function(){const e=$(this);Promise.all([o.e(20056),o.e(17205)]).then(function(){var r=[o(17205)];(function(l){l.init(e.parents("[data-pid]"))}).apply(null,r)}).catch(o.oe)}),a.on("click",'[component="post/manage-editors"]',function(){const e=$(this);Promise.all([o.e(20056),o.e(24459)]).then(function(){var r=[o(24459)];(function(l){l.init(e.parents("[data-pid]"))}).apply(null,r)}).catch(o.oe)}),a.on("click",'[component="post/ban-ip"]',function(){const e=$(this).attr("data-ip");socket.emit("blacklist.addRule",e,function(r){if(r)return p.error(r);p.success("[[admin/manage/blacklist:ban-ip]]")})}),a.on("click",'[component="post/chat"]',function(){Z($(this))})}async function f(i,a){const s=await E();z(async function(){let e=await N(i);(m(i,"data-uid")==="0"||!m(i,"data-userslug"))&&(e="");const r=i.is('[component="post/reply"]')?m(i,"data-pid"):null,l=!r||!s.pid||r===s.pid;s.text&&l?(e=e||s.username,g.fire("action:composer.addQuote",{tid:a,pid:r,title:ajaxify.data.titleRaw,username:e,body:s.text,selectedPid:s.pid})):g.fire("action:composer.post.new",{tid:a,pid:r,title:ajaxify.data.titleRaw,body:e?e+" ":$('[component="topic/quickreply/text"]').val()||""})})}async function w(i,a){const s=await E();z(async function(){const e=await N(i),r=m(i,"data-pid");function l(t){g.fire("action:composer.addQuote",{tid:a,pid:r,username:e,title:ajaxify.data.titleRaw,text:t})}if(s.text&&r&&r===s.pid)return l(s.text);const{content:U}=await A.get(`/posts/${encodeURIComponent(r)}/raw`);l(U)})}async function E(){let i="",a,s="";const e=window.getSelection?window.getSelection():document.selection.createRange(),r=$('[component="post"] [component="post/content"]');let l;return r.each(function(U,t){e&&e.containsNode&&t&&e.containsNode(t,!0)&&(l=t)}),l&&e&&(i=e.toString(),a=$(l).parents('[component="post"]').attr("data-pid"),s=await N($(l))),{text:i,pid:a,username:s}}function u(i,a){const s=i.attr("data-bookmarked")==="false"?"put":"del";return A[s](`/posts/${encodeURIComponent(a)}/bookmark`,void 0,function(e){if(e)return p.error(e);const r=s==="put"?"bookmark":"unbookmark";g.fire(`action:post.${r}`,{pid:a})}),!1}function m(i,a){return i.parents("[data-pid]").attr(a)}function N(i){return new Promise(a=>{let s="";if(i.attr("component")==="topic/reply"){a(s);return}const e=i.parents("[data-pid]");if(e.length&&!e.hasClass("self-post")){Promise.all([o.e(53050),o.e(26174)]).then(function(){var r=[o(13230)];(function(l){s=l(e.attr("data-username"),!0),s||(e.attr("data-uid")!=="0"?s="[[global:former-user]]":s="[[global:guest]]"),s&&s!=="[[global:former-user]]"&&s!=="[[global:guest]]"&&(s="@"+s),a(s)}).apply(null,r)}).catch(o.oe);return}a(s)})}function j(i){const a=m(i,"data-pid"),e=D.get("post","pid",a).hasClass("deleted")?"restore":"delete";O(e,a)}function Y(i){O("purge",m(i,"data-pid"))}async function O(i,a){({action:i}=await g.fire(`static:post.${i}`,{action:i,pid:a})),i&&R.confirm("[[topic:post-"+i+"-confirm]]",function(s){if(!s)return;const e=i==="purge"?"":"/state";A[i==="restore"?"put":"del"](`/posts/${encodeURIComponent(a)}${e}`).catch(p.error)})}function Z(i){const a=i.parents("[data-pid]");return o.e(92619).then(function(){var s=[o(92619)];(function(e){e.newChat(a.attr("data-uid"))}).apply(null,s)}).catch(o.oe),i.parents(".btn-group").find(".dropdown-toggle").click(),!1}function z(i){if(!parseInt(ajaxify.data.topicStaleDays,10))return i();const s=Math.min(Date.now()-1e3*60*60*24*ajaxify.data.topicStaleDays,864e13);if(d||ajaxify.data.lastposttime>=s)return i();R.dialog({title:"[[topic:stale.title]]",message:"[[topic:stale.warning]]",buttons:{reply:{label:"[[topic:stale.reply-anyway]]",className:"btn-link",callback:function(){d=!0,i()}},create:{label:"[[topic:stale.create]]",className:"btn-primary",callback:function(){I.translate(`[[topic:link-back, ${ajaxify.data.title}, ${config.relative_path}/topic/${ajaxify.data.slug}]]`,function(r){g.fire("action:composer.topic.new",{cid:ajaxify.data.cid,body:r,fromStaleTopic:!0})})}}}}).modal()}const G=utils.debounce(_,250);function q(){ajaxify.data.privileges["topics:reply"]&&(g.onPage("action:posts.loaded",X),$(document).off("selectionchange"),$(document).on("selectionchange",function(){window.getSelection().toString()===""&&$('[component="selection/tooltip"]').addClass("hidden")}),$(document).on("selectionchange",G))}function _(){window.getSelection().toString()===""||X()}async function X(){let i=$('[component="selection/tooltip"]');if(i.addClass("hidden"),i.attr("data-ajaxify")==="1"){i.remove();return}const a=window.getSelection();if(a.focusNode&&a.type==="Range"&&ajaxify.data.template.topic){const s=$(a.focusNode),e=$(a.anchorNode),r=e.parents("[data-pid]").attr("data-pid"),l=s.parents("[data-pid]").attr("data-pid");if(r!==l||!s.parents('[component="post/content"]').length||!e.parents('[component="post/content"]').length)return;const U=s.parents("[data-pid]"),t=a.getRangeAt(0);if(!U.length||t.collapsed)return;const n=t.getClientRects(),c=n[n.length-1];i.length||(i=await app.parseAndTranslate("partials/topic/selection-tooltip",ajaxify.data),$('[component="selection/tooltip"]').remove(),i.addClass("hidden").appendTo("body")),i.off("click").on("click",'[component="selection/tooltip/quote"]',function(){i.addClass("hidden"),w(U.find('[component="post/quote"]'),ajaxify.data.tid)}),i.removeClass("hidden"),$(window).one("action:ajaxify.start",function(){i.attr("data-ajaxify",1).addClass("hidden"),$(document).off("selectionchange",G)});const h=i.outerWidth(!0);i.css({top:c.bottom+$(window).scrollTop(),left:h>c.width?c.left:c.left+c.width-h})}}return M}).apply(S,C),b!==void 0&&(B.exports=b)}),24962:((B,S,o)=>{var C,b;C=[o(91749)],b=(function(P){const W={},D=window.location.protocol+"//"+window.location.host;W.addShareHandlers=function(A){function R(p,g,k,M){return window.open(p,"_blank","width="+k+",height="+M+",scrollbars=no,status=no"),P.fire("action:share.open",{url:p,urlToPost:g}),!1}$("#content").off("shown.bs.dropdown",".share-dropdown").on("shown.bs.dropdown",".share-dropdown",function(){const p=$(this).find(".post-link");p.val(D+x($(this))),setTimeout(function(){p.putCursorAtEnd().select()},50)}),I(".post-link",function(p){return p.preventDefault(),!1}),I('[component="share/twitter"]',function(){const p=x($(this)),g=`https://twitter.com/intent/tweet?text=${encodeURIComponent(A)}&url=${encodeURIComponent(p)}`;return R(g,p,550,420)}),I('[component="share/facebook"]',function(){const p=x($(this)),g=`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(p)}`;return R(g,p,626,436)}),I('[component="share/whatsapp"]',function(){const p=x($(this)),g=encodeURIComponent(A)+" - "+encodeURIComponent(p),k=config.useragent.isMobile?`whatsapp://send?text=${g}`:`https://wa.me/?text=${g}`;return R(k,p,626,436)}),I('[component="share/telegram"]',function(){const p=x($(this)),g=`https://t.me/share/url?text=${encodeURIComponent(A)}&url=${encodeURIComponent(p)}`;return R(g,p,626,436)}),I('[component="share/linkedin"]',function(){const p=x($(this)),g=`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(p)}`;return R(g,p,626,436)}),P.fire("action:share.addHandlers",{openShare:R})};function I(A,R){$("#content").off("click",A).on("click",A,R)}function x(A){const R=parseInt(A.parents("[data-pid]").attr("data-pid"),10),p="/post"+(R?"/"+R:"");return D+config.relative_path+p}return W}).apply(S,C),b!==void 0&&(B.exports=b)}),29869:(B=>{B.exports=function(S,o,C){o.setGlobal("true",!0),o.setGlobal("false",!1);const b=1440*60*1e3,P={displayMenuItem:D,buildMetaTag:I,buildLinkTag:x,stringify:A,escape:R,stripTags:p,buildCategoryIcon:g,buildCategoryLabel:k,generateCategoryBackground:M,generateChildrenCategories:d,generateTopicClass:v,membershipBtn:y,spawnPrivilegeStates:f,localeToHTML:w,renderTopicImage:E,renderDigestAvatar:u,userAgentIcons:m,buildAvatar:N,increment:j,lessthan:Y,greaterthan:O,generateWroteReplied:Z,generateRepliedTo:z,generateWrote:G,encodeURIComponent:q,isoTimeToLocaleString:_,shouldHideReplyContainer:X,humanReadableNumber:i,formattedNumber:a,isNumber:s,txEscape:e,uploadBasename:r,generatePlaceholderWave:l,register:U,__escape:W};function W(t){return t}function D(t,n){const c=t.navigation[n];return!(!c||c.route.match("/users")&&t.user&&!t.user.privileges["view:users"]||c.route.match("/tags")&&t.user&&!t.user.privileges["view:tags"]||c.route.match("/groups")&&t.user&&!t.user.privileges["view:groups"])}function I(t){const n=t.name?'name="'+t.name+'" ':"",c=t.property?'property="'+t.property+'" ':"",h=t.content?'content="'+t.content.replace(/\n/g," ")+'" ':"";return"<meta "+n+c+h+`/>
	`}function x(t){const n=["link","rel","as","type","href","hreflang","sizes","title","crossorigin"],[c,h,H,T,L,F,K,Q,V]=n.map(J=>t[J]?`${J}="${t[J]}" `:"");return"<link "+c+h+H+T+K+Q+L+F+V+`/>
	`}function A(t){return JSON.stringify(t).replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/g,"&quot;")}function R(t){return S.escapeHTML(t)}function p(t){return S.stripHTMLTags(t)}function g(t,n,c){return t?`<span class="icon d-inline-flex justify-content-center align-items-center align-middle ${c}" style="${M(t)} width:${n}; height: ${n}; font-size: ${parseInt(n,10)/2}px;">${t.icon?`<i class="fa fa-fw ${t.icon}"></i>`:""}</span>`:""}function k(t,n="a",c=""){if(!t)return"";const h=n==="a"?`href="${C}/category/${t.slug}"`:"";return`<${n} component="topic/category" ${h} class="badge px-1 text-truncate text-decoration-none ${c}" style="color: ${t.color};background-color: ${t.bgColor};border-color: ${t.bgColor}!important; max-width: 70vw;">
			${t.icon&&t.icon!=="fa-nbb-none"?`<i class="fa fa-fw ${t.icon}"></i>`:""}
			${t.name}
		</${n}>`}function M(t){if(!t)return"";const n=[];return t.bgColor&&(n.push("background-color: "+t.bgColor),n.push(`border-color: ${t.bgColor}!important`)),t.color&&n.push("color: "+t.color),t.backgroundImage&&(n.push("background-image: url("+t.backgroundImage+")"),t.imageClass&&n.push("background-size: "+t.imageClass)),n.join("; ")+";"}function d(t){let n="";return!t||!t.children||!t.children.length||(t.children.forEach(function(c){if(c&&!c.isSection){const h=c.link?c.link:C+"/category/"+c.slug;n+='<span class="category-children-item float-start"><div role="presentation" class="icon float-start" style="'+M(c)+'"><i class="fa fa-fw '+c.icon+'"></i></div><a href="'+h+'"><small>'+c.name+"</small></a></span>"}}),n=n&&'<span class="category-children">'+n+"</span>"),n}function v(t){return["locked","pinned","deleted","unread","scheduled"].filter(c=>!!t[c]).join(" ")}function y(t,n=""){return t.isMember&&t.name!=="administrators"?`<button class="btn btn-danger ${n}" data-action="leave" data-group="${t.displayName}" ${t.disableLeave?" disabled":""}><i class="fa fa-times"></i> [[groups:membership.leave-group]]</button>`:t.isPending&&t.name!=="administrators"?`<button class="btn btn-warning disabled ${n}"><i class="fa fa-clock-o"></i> [[groups:membership.invitation-pending]]</button>`:t.isInvited?`<button class="btn btn-warning" data-action="rejectInvite" data-group="${t.displayName}">[[groups:membership.reject]]</button><button class="btn btn-success" data-action="acceptInvite" data-group="${t.name}"><i class="fa fa-plus"></i> [[groups:membership.accept-invitation]]</button>`:!t.disableJoinRequests&&t.name!=="administrators"?`<button class="btn btn-success ${n}" data-action="join" data-group="${t.displayName}"><i class="fa fa-plus"></i> [[groups:membership.join-group]]</button>`:""}function f(t,n,c,h){const H=[];for(const[T,L]of Object.entries(c))H.push({name:T,state:L,type:h[T]});return H.map(function(T){const L=["groups:moderate","groups:posts:upvote","groups:posts:downvote","groups:local:login","groups:group:create"],F=["groups:find","groups:read","groups:topics:read","groups:view:users","groups:view:tags","groups:view:groups"],K=["groups:moderate"];let Q=["groups:view:users","groups:find","groups:read","groups:topics:read","groups:topics:create","groups:topics:reply","groups:topics:tag","groups:posts:edit","groups:posts:history","groups:posts:delete","groups:posts:upvote","groups:posts:downvote","groups:topics:delete"];t===-1&&(Q=Q.slice(3));const V=n==="guests"&&(L.includes(T.name)||T.name.startsWith("groups:admin:"))||n==="spiders"&&!F.includes(T.name)||n==="fediverse"&&!Q.includes(T.name)||n==="Global Moderators"&&K.includes(T.name);return`
				<td data-privilege="${T.name}" data-value="${T.state}" data-type="${T.type}">
					<div class="form-check text-center">
						<input class="form-check-input float-none${V?' d-none"':""}" autocomplete="off" type="checkbox"${T.state?" checked":""}${V?' disabled="disabled" aria-diabled="true"':""} />
					</div>
				</td>
			`}).join("")}function w(t,n){return t=t||n||"en-GB",t.replace("_","-")}function E(t){return t.thumb?'<img src="'+t.thumb+'" class="img-circle user-img" title="'+t.user.displayname+'" />':'<img component="user/picture" data-uid="'+t.user.uid+'" src="'+t.user.picture+'" class="user-img" title="'+t.user.displayname+'" />'}function u(t){return t.teaser?t.teaser.user.picture?'<img style="vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;" src="'+t.teaser.user.picture+'" title="'+t.teaser.user.username+'" />':'<div style="vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: '+t.teaser.user["icon:bgColor"]+'; color: white; text-align: center; display: inline-block; border-radius: 50%;">'+t.teaser.user["icon:text"]+"</div>":t.user.picture?'<img style="vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;" src="'+t.user.picture+'" title="'+t.user.username+'" />':'<div style="vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: '+t.user["icon:bgColor"]+'; color: white; text-align: center; display: inline-block; border-radius: 50%;">'+t.user["icon:text"]+"</div>"}function m(t){let n="";switch(t.platform){case"Linux":n+='<i class="fa fa-fw fa-linux"></i>';break;case"Microsoft Windows":n+='<i class="fa fa-fw fa-windows"></i>';break;case"Apple Mac":n+='<i class="fa fa-fw fa-apple"></i>';break;case"Android":n+='<i class="fa fa-fw fa-android"></i>';break;case"iPad":n+='<i class="fa fa-fw fa-tablet"></i>';break;case"iPod":case"iPhone":n+='<i class="fa fa-fw fa-mobile"></i>';break;default:n+='<i class="fa fa-fw fa-question-circle"></i>';break}switch(t.browser){case"Chrome":n+='<i class="fa fa-fw fa-chrome"></i>';break;case"Firefox":n+='<i class="fa fa-fw fa-firefox"></i>';break;case"Safari":n+='<i class="fa fa-fw fa-safari"></i>';break;case"IE":n+='<i class="fa fa-fw fa-internet-explorer"></i>';break;case"Edge":n+='<i class="fa fa-fw fa-edge"></i>';break;default:n+='<i class="fa fa-fw fa-question-circle"></i>';break}return n}function N(t,n,c,h,H){t||(t=this),h=h||"";const T=new Map([["title",t.displayname],["data-uid",t.uid],["class",`avatar ${h}${c?" avatar-rounded":""}`]]),L=[`--avatar-size: ${n};`],F=Q=>Array.from(Q).reduce((V,[J,tt])=>(V+=` ${J}="${tt}"`,V),"");let K="";return t.picture&&(K+=`<img${F(T)} alt="${t.displayname}" loading="lazy" component="${H||"avatar/picture"}" src="${t.picture}" style="${L.join(" ")}" onError="this.remove()" itemprop="image" />`),K+=`<span${F(T)} component="${H||"avatar/icon"}" style="${L.join(" ")} background-color: ${t["icon:bgColor"]}">${t["icon:text"]}</span>`,K}function j(t,n){return String(t+parseInt(n,10))}function Y(t,n){return parseInt(t,10)<parseInt(n,10)}function O(t,n){return parseInt(t,10)>parseInt(n,10)}function Z(t,n){return t.toPid?z(t,n):G(t,n)}function z(t,n){const c=t.parent&&t.parent.displayname?t.parent.displayname:"[[global:guest]]";return`[[topic:replied-to-user-${t.timestamp<Date.now()-n*b?"on":"ago"}, ${t.toPid}, ${C}/post/${encodeURIComponent(t.toPid)}, ${c}, ${C}/post/${encodeURIComponent(t.pid)}, ${t.timestampISO}]]`}function G(t,n){return`[[topic:wrote-${t.timestamp<Date.now()-n*b?"on":"ago"}, ${C}/post/${encodeURIComponent(t.pid)}, ${t.timestampISO}]]`}function q(t){return encodeURIComponent(t)}function _(t,n="en-GB"){return new Date(t).toLocaleString([n],{dateStyle:"short",timeStyle:"short"}).replace(/,/g,"&#44;")}function X(t){return!!(t.replies.count<=0||t.replies.hasSingleImmediateReply)}function i(t,n=1){return S.makeNumberHumanReadable(t,n)}function a(t){return S.addCommas(t)}function s(t){return S.isNumber(t)}function e(t){return String(t).replace(/%/g,"&#37;").replace(/,/g,"&#44;")}function r(t,n="/"){const c=/^\d+-/,h=t.substr(t.lastIndexOf(n)+1);return c.test(h)?h.slice(14):h}function l(t){return t.map(c=>c==="divider"?'<li class="dropdown-divider"></li>':`
			<li class="dropdown-item placeholder-wave">
				<div class="placeholder" style="width: 20px;"></div>
				<div class="placeholder col-${c}"></div>
			</li>`).join("")}function U(){Object.keys(P).forEach(function(t){o.registerHelper(t,P[t])})}return P}}),30076:((B,S,o)=>{var C,b;const P=o(29869);C=[o(77918),o(81335)],b=(function(W,D){return P(W,D,config.relative_path)}).apply(S,C),b!==void 0&&(B.exports=b)}),34342:((B,S,o)=>{var C,b;C=[o(52473),o(17459),o(49897),o(91749),o(33530),o(29930),o(89336)],b=(function(P,W,D,I,x,A,R){const p={};let g={};p.addVoteHandler=function(){g={},k()&&(P.get("topic").on("mouseenter",'[data-pid] [component="post/vote-count"]',v),P.get("topic").on("mouseleave",'[data-pid] [component="post/vote-count"]',d)),P.get("topic").on("mouseenter",'[data-pid] [component="post/announce-count"]',v),P.get("topic").on("mouseleave",'[data-pid] [component="post/announce-count"]',d)};function k(){const{upvoteVisibility:f,privileges:w}=ajaxify.data;return w.isAdminOrMod||f==="all"||f==="loggedin"&&config.loggedIn}function M(){const{upvoteVisibility:f,downvoteVisibility:w,privileges:E}=ajaxify.data;return E.isAdminOrMod||f==="all"||w==="all"||(f==="loggedin"||w==="loggedin")&&config.loggedIn}function d(){const f=$(this),w=f.parents("[data-pid]").attr("data-pid"),E=R.Tooltip.getInstance(this);E&&(E.dispose(),f.attr("title","")),g[w]=!1}function v(){const f=$(this),E=f.parent().parents("[data-pid]").attr("data-pid");g[E]=!0;const u=R.Tooltip.getInstance(this);u&&(u.dispose(),f.attr("title",""));const m=f.attr("component")==="post/vote-count"?`/posts/${encodeURIComponent(E)}/upvoters`:`/posts/${encodeURIComponent(E)}/announcers/tooltip`;D.get(m,{},function(N,j){if(N)return A.error(N);g[E]&&j&&y(f,j)})}function y(f,w){function E(m){f.attr("title",m),new R.Tooltip(f,{container:"#content",html:!0}).show()}let u=w.usernames.filter(m=>m!=="[[global:former-user]]");u.length&&(u.length+w.otherCount>w.cutoff?(u=u.join(", ").replace(/,/g,"|"),W.translate("[[topic:users-and-others, "+u+", "+w.otherCount+"]]",function(m){m=m.replace(/\|/g,","),E(m)})):(u=u.join(", "),E(u)))}return p.toggleVote=function(f,w,E){const u=f.closest("[data-pid]"),N=u.find(w).length?"del":"put",j=u.attr("data-pid");return D[N](`/posts/${encodeURIComponent(j)}/vote`,{delta:E},function(Y){if(Y){if(!app.user.uid){ajaxify.go("login");return}return A.error(Y)}I.fire("action:post.toggleVote",{pid:j,delta:E,unvote:N==="del"})}),!1},p.showVotes=function(f){M()&&D.get(`/posts/${encodeURIComponent(f)}/voters`,{},function(w,E){if(w)return A.error(w);app.parseAndTranslate("modals/votes",E,function(u){const m=x.dialog({title:"[[global:voters]]",message:u,className:"vote-modal",show:!0,onEscape:!0,backdrop:!0});m.on("click",function(){m.modal("hide")})})})},p.showAnnouncers=async function(f){const w=await D.get(`/posts/${encodeURIComponent(f)}/announcers`,{}).catch(m=>A.error(m)),E=await app.parseAndTranslate("modals/announcers",w),u=x.dialog({title:`[[topic:announcers-x, ${w.announceCount}]]`,message:E,className:"announce-modal",show:!0,onEscape:!0,backdrop:!0});u.on("click",function(){u.modal("hide")})},p}).apply(S,C),b!==void 0&&(B.exports=b)}),49897:((B,S,o)=>{o.r(S),o.d(S,{del:()=>M,get:()=>A,head:()=>R,patch:()=>g,post:()=>p,put:()=>k});var C=o(91749),b=o.n(C),P=o(33530),W=o.n(P);const D=config.relative_path+"/api/v3";async function I(d,v){if(d.url=d.url.startsWith("/api")?config.relative_path+d.url:D+d.url,typeof v=="function"){x(d).then(y=>v(null,y),y=>v(y));return}try{return await x(d)}catch(y){if(y.message==="A valid login session was not found. Please log in and try again."){const{url:f}=await(0,C.fire)("filter:admin.reauth",{url:"login"});return(0,P.confirm)("[[error:api.reauth-required]]",w=>{w&&ajaxify.go(f)})}throw y}}async function x(d){const{url:v}=d;delete d.url,d.data&&!(d.data instanceof FormData)&&(d.data=JSON.stringify(d.data||{}),d.headers["content-type"]="application/json; charset=utf-8"),{options:d}=await(0,C.fire)("filter:api.options",{options:d}),d.data&&(d.body=d.data,delete d.data);const y=await fetch(v,d),{headers:f}=y;if(f.get("x-redirect"))return x({url:f.get("x-redirect"),...d});const w=f.get("content-type"),E=w&&w.startsWith("application/json");let u;if(d.method!=="HEAD"&&(E?u=await y.json():u=await y.text()),!y.ok)throw u?new Error(E?u.status.message:u):new Error(y.statusText);return E&&u&&u.hasOwnProperty("status")&&u.hasOwnProperty("response")?u.response:u}function A(d,v,y){return I({url:d+(v&&Object.keys(v).length?"?"+$.param(v):"")},y)}function R(d,v,y){return I({url:d+(v&&Object.keys(v).length?"?"+$.param(v):""),method:"HEAD"},y)}function p(d,v,y){return I({url:d,method:"POST",data:v,headers:{"x-csrf-token":config.csrf_token}},y)}function g(d,v,y){return I({url:d,method:"PATCH",data:v,headers:{"x-csrf-token":config.csrf_token}},y)}function k(d,v,y){return I({url:d,method:"PUT",data:v,headers:{"x-csrf-token":config.csrf_token}},y)}function M(d,v,y){return I({url:d,method:"DELETE",data:v,headers:{"x-csrf-token":config.csrf_token}},y)}})}]);
