"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[25285,77597],{31799:((u,m,c)=>{var y,d;y=[c(22410),c(96352),c(47682),c(43349),c(65348),c(91749),c(29930),c(49897),c(57576)],d=(function(p,g,h,C,f,t,o,s,a){const i={};$(window).on("action:ajaxify.start",function(e,r){String(r.url).startsWith("category/")||g.disable()}),i.init=function(){const e=ajaxify.data.cid;app.enterRoom("category_"+e),h.init("category",j),C.handleSort("categoryTopicSort","category/"+ajaxify.data.slug),config.usePagination?g.disable():g.init('[component="category/topic"]',ajaxify.data.topic_count,i.toTop,i.toBottom),l(),x(e),A(),b(),f.init($('[component="category-selector"]'),{privilege:"find",parentCid:ajaxify.data.cid,onSelect:function(r){ajaxify.go("/category/"+r.cid)}}),new a("[data-clipboard-text]"),t.fire("action:topics.loaded",{topics:ajaxify.data.topics}),t.fire("action:category.loaded",{cid:ajaxify.data.cid})};function l(){let e=ajaxify.data.topicIndex;e&&utils.isNumber(e)&&(e=Math.max(0,parseInt(e,10)),e&&window.location.search.indexOf("page=")===-1&&g.scrollToElement($('[component="category/topic"][data-index="'+e+'"]'),!0,0))}function x(e){$('[component="category/watching"], [component="category/tracking"], [component="category/ignoring"], [component="category/notwatching"]').on("click",function(){const n=$(this).attr("data-state");s.put(`/categories/${encodeURIComponent(e)}/watch`,{state:n},S=>{if(S)return o.error(S);$('[component="category/watching/menu"]').toggleClass("hidden",n!=="watching"),$('[component="category/watching/check"]').toggleClass("fa-check",n==="watching"),$('[component="category/tracking/menu"]').toggleClass("hidden",n!=="tracking"),$('[component="category/tracking/check"]').toggleClass("fa-check",n==="tracking"),$('[component="category/notwatching/menu"]').toggleClass("hidden",n!=="notwatching"),$('[component="category/notwatching/check"]').toggleClass("fa-check",n==="notwatching"),$('[component="category/ignoring/menu"]').toggleClass("hidden",n!=="ignoring"),$('[component="category/ignoring/check"]').toggleClass("fa-check",n==="ignoring"),o.success("[[category:"+n+".message]]")})})}function A(){$('[component="category/load-more-subcategories"]').on("click",async function(){const e=$(this),{categories:r}=await s.get(`/categories/${ajaxify.data.cid}/children?start=${ajaxify.data.nextSubCategoryStart}`);if(e.toggleClass("hidden",!r.length||r.length<ajaxify.data.subCategoriesPerPage),!!r.length)return app.parseAndTranslate("category","children",{children:r},function(n){n.find(".timeago").timeago(),$('[component="category/subcategory/container"]').append(n),ajaxify.data.nextSubCategoryStart+=ajaxify.data.subCategoriesPerPage,ajaxify.data.subCategoriesLeft-=r.length,e.toggleClass("hidden",ajaxify.data.subCategoriesLeft<=0).translateText("[[category:x-more-categories, "+ajaxify.data.subCategoriesLeft+"]]")}),!1})}function b(){const e=document.querySelector(".description.clamp-fade-4");e&&e.addEventListener("click",()=>{const r=e.classList.contains("line-clamp-4");e.classList.toggle("line-clamp-4",!r)})}i.toTop=function(){g.scrollTop(0)},i.toBottom=async()=>{const{count:e}=await s.get(`/categories/${encodeURIComponent(ajaxify.data.category.cid)}/count`);g.scrollBottom(e-1)};function j(e,r,n){n=n||function(){},t.fire("action:topics.loading");const S=utils.params();p.loadMore(`/categories/${encodeURIComponent(ajaxify.data.cid)}/topics`,{after:e,direction:r,query:S,categoryTopicSort:S.sort||config.categoryTopicSort},function(E,w){t.fire("action:topics.loaded",{topics:E.topics}),n(E,w)})}return i}).apply(m,y),d!==void 0&&(u.exports=d)}),43349:((u,m,c)=>{var y,d;y=[c(52473)],d=(function(p){const g={};return g.handleSort=function(h,C){const f=p.get("thread/sort");f.find("i").removeClass("fa-check");const t=utils.params().sort||config[h];f.find('a[data-sort="'+t+'"]').find("i").addClass("fa-check"),$("body").off("click",'[component="thread/sort"] a[data-sort]').on("click",'[component="thread/sort"] a[data-sort]',function(){const s=$(this).attr("data-sort"),a=utils.params();a.sort=s;const i=$.param(a);ajaxify.go(C+(i?"?"+i:""))})},g}).apply(m,y),d!==void 0&&(u.exports=d)}),65348:((u,m,c)=>{var y,d;y=[c(96349),c(33530),c(91749),c(17459)],d=(function(p,g,h,C){const f={};return f.init=function(t,o){if(!t||!t.length)return;o=o||{};const s=o.onSelect||function(){};o.states=o.states||["watching","tracking","notwatching","ignoring"],o.template=o.template||"partials/category/selector-dropdown-left",h.fire("action:category.selector.options",{el:t,options:o}),p.init(t,o);const a={el:t,selectedCategory:null};t.on("click","[data-cid]",function(){const l=$(this);return l.hasClass("disabled")?!1:(a.selectCategory(l.attr("data-cid")),s(a.selectedCategory))});let i=a.el.find('[component="category-selector-selected"]').html();return C.translate(i,l=>{i=l}),a.selectCategory=function(l){const x=a.el.find('[data-cid="'+l+'"]');a.selectedCategory={cid:l,name:x.attr("data-name")},x.length?a.el.find('[component="category-selector-selected"]').html(x.find('[component="category-markup"]').html()):a.el.find('[component="category-selector-selected"]').html(i)},a.getSelectedCategory=function(){return a.selectedCategory},a.getSelectedCid=function(){return a.selectedCategory?a.selectedCategory.cid:0},o.hasOwnProperty("selectedCategory")&&app.parseAndTranslate(o.template,{selectedCategory:o.selectedCategory},function(l){a.el.find('[component="category-selector-selected"]').html(l.find('[component="category-selector-selected"]').html())}),a},f.modal=function(t){t=t||{},t.onSelect=t.onSelect||function(){},t.onSubmit=t.onSubmit||function(){},app.parseAndTranslate("admin/partials/categories/select-category",{message:t.message},function(o){const s=g.dialog({title:t.title||"[[modules:composer.select-category]]",message:o,buttons:{save:{label:"[[global:select]]",className:"btn-primary",callback:i}}}),a=f.init(s.find('[component="category-selector"]'),t);function i(l){return l.preventDefault(),a.selectedCategory&&(t.onSubmit(a.selectedCategory),s.modal("hide")),!1}t.openOnLoad&&s.on("shown.bs.modal",function(){s.find(".dropdown-toggle").dropdown("toggle")}),s.find("form").on("submit",i)})},f}).apply(m,y),d!==void 0&&(u.exports=d)})}]);
