(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[1091,25764,33069,34271,49897,69185,86198,99127],{13342:((y,C,l)=>{y.exports=l(41644)}),14063:((y,C,l)=>{"use strict";y=l.nmd(y);var h,m;h=[l(17459),l(91749)],m=(function(E,b){const o={};let s=!1;o.init=function(){if(o.taskbar=$('[component="taskbar"]'),o.tasklist=o.taskbar.find("ul"),!o.taskbar.length||!o.tasklist.length){s=!0;return}o.taskbar.on("click","li",async function(){const t=$(this),a=t.attr("data-module"),n=t.attr("data-uuid"),e=await app.require(a);return t.hasClass("active")?e.minimize(n):(r(),e.load(n),o.toggleNew(n,!1),o.tasklist.removeClass("active"),t.addClass("active")),!1}),$(window).on("action:app.loggedOut",function(){o.closeAll()})},o.close=async function(t,a){if(s)return;if(o.tasklist.find('[data-module="'+y+'"][data-uuid="'+a+'"]').length){const e=await app.require(t);e&&typeof e.close=="function"&&e.close(a)}},o.closeAll=function(t){if(s)return;let a="[data-uuid]";t&&(a='[data-module="'+t+'"]'+a),o.tasklist.find(a).each(function(n,e){o.close(t||e.getAttribute("data-module"),e.getAttribute("data-uuid"))})},o.discard=function(t,a){if(s)return;o.tasklist.find('[data-module="'+t+'"][data-uuid="'+a+'"]').remove(),f()},o.push=function(t,a,n,e){if(e=e||function(){},s)return e();const i=o.tasklist.find('li[data-uuid="'+a+'"]'),c={module:t,uuid:a,options:n,element:i};b.fire("filter:taskbar.push",c),!i.length&&c.module?d(c,e):e(i)},o.get=function(t){return s?[]:$('[data-module="'+t+'"]').map(function(n,e){return $(e).data()})},o.minimize=function(t,a){if(s)return;o.tasklist.find('[data-module="'+t+'"][data-uuid="'+a+'"]').toggleClass("active",!1)},o.toggleNew=function(t,a,n){if(s)return;o.tasklist.find('[data-uuid="'+t+'"]').toggleClass("new",a),n||b.fire("action:taskbar.toggleNew",t)},o.updateActive=function(t){if(s)return;const a=o.tasklist.find("li");a.removeClass("active"),a.filter('[data-uuid="'+t+'"]').addClass("active"),$("[data-uuid]:not([data-module])").toggleClass("modal-unfocused",!0),$('[data-uuid="'+t+'"]:not([data-module])').toggleClass("modal-unfocused",!1)},o.isActive=function(t){return s?!1:o.tasklist.find('li[data-uuid="'+t+'"]').hasClass("active")};function f(){if(s)return;o.tasklist.find("li").length>0?o.taskbar.attr("data-active","1"):o.taskbar.removeAttr("data-active")}function r(){s||o.tasklist.find(".active").removeClass("active")}function d(t,a){if(s)return a();E.translate(t.options.title,function(n){const e=$("<div></div>").text(n||"NodeBB Task").html(),i=$("<li></li>").addClass(t.options.className).html('<a href="#"'+(t.options.image?` style="background-image: url('`+t.options.image.replace(/&#x2F;/g,"/")+`'); background-size: cover;"`:"")+">"+(t.options.icon?'<i class="fa '+t.options.icon+'"></i> ':"")+'<span aria-label="'+e+'" component="taskbar/title">'+e+"</span></a>").attr({title:e,"data-module":t.module,"data-uuid":t.uuid}).addClass(t.options.state!==void 0?t.options.state:"active");(!t.options.state||t.options.state==="active")&&r(),o.tasklist.append(i),f(),t.element=i,i.data(t),b.fire("action:taskbar.pushed",t),a(i)})}const g=function(t,a,n){switch(a){case"title":t.find('[component="taskbar/title"]').text(n);break;case"icon":t.find("i").attr("class","fa fa-"+n);break;case"image":t.find("a").css("background-image",n?'url("'+n.replace(/&#x2F;/g,"/")+'")':"");break;case"background-color":t.find("a").css("background-color",n);break;case"color":t.find("a").css("color",n);break}};return o.update=function(t,a,n){if(s)return;const e=o.tasklist.find('[data-module="'+t+'"][data-uuid="'+a+'"]');if(!e.length)return;const i=e.data();Object.keys(n).forEach(function(c){i[c]=n[c],g(e,c,n[c])}),e.data(i)},o}).apply(C,h),m!==void 0&&(y.exports=m)}),41644:((y,C,l)=>{"use strict";var h,m;h=[l(65348),l(14063),l(49897)],m=(function(E,b,o){var s={},f;s.init=function(a,n){var e=a.find(".category-list-container");e.length&&(a.on("action:composer.resize",function(){r(a)}),s.updateTaskbar(a,n),f=E.init(e.find('[component="category-selector"]'),{privilege:"topics:create",states:["watching","tracking","notwatching","ignoring"],onSelect:function(i){n.hasOwnProperty("cid")&&t(a,n,i)}}),f&&(n.cid&&n.category?f.selectedCategory={cid:n.cid,name:n.category.name}:ajaxify.data.template.compose&&ajaxify.data.selectedCategory&&(f.selectedCategory={cid:ajaxify.data.cid,name:ajaxify.data.selectedCategory}),a.find(".category-name").translateHtml(f.selectedCategory?f.selectedCategory.name:"[[modules:composer.select-category]]").on("click",function(){E.modal({privilege:"topics:create",states:["watching","tracking","notwatching","ignoring"],openOnLoad:!0,showLinks:!1,onSubmit:function(i){a.find(".category-name").text(i.name),f.selectCategory(i.cid),n.hasOwnProperty("cid")&&t(a,n,i)}})}),r(a)))};function r(a){a.find('.category-list-container [component="category-selector"]').toggleClass("dropup",a.outerHeight()<$(window).height()/2)}s.getSelectedCid=function(){var a;return f&&(a=f.getSelectedCategory()),a?a.cid:0},s.updateTaskbar=function(a,n){parseInt(n.cid,10)&&o.get(`/categories/${n.cid}`,{}).then(function(e){d(a,e)})};function d(a,n){if(n){var e=a.attr("data-uuid");b.update("composer",e,{image:n.backgroundImage,color:n.color,"background-color":n.bgColor,icon:n.icon&&n.icon.slice(3)})}}function g(a,n,e){const i=a.find("textarea.write").val(),c=e&&e.topicTemplate;n&&(!i.length||i===c)&&i!==n.topicTemplate&&a.find("textarea.write").val(n.topicTemplate).trigger("input")}async function t(a,n,e){const i=n.category;n.cid=e.cid;const c=await window.fetch(`${config.relative_path}/api/category/${encodeURIComponent(e.cid)}`).then(u=>u.json());n.category=c,d(a,c),g(a,c,i),l.e(56382).then(function(){var u=[l(72573),l(52543),l(92762)];(function(k,v,p){k.onChangeCategory(c),v.onChangeCategory(a,n,e.cid,c),p.onChangeCategory(a,n),$(window).trigger("action:composer.changeCategory",{postContainer:a,postData:n,selectedCategory:e,categoryData:c})}).apply(null,u)}).catch(l.oe)}return s}).apply(C,h),m!==void 0&&(y.exports=m)}),49897:((y,C,l)=>{"use strict";l.r(C),l.d(C,{del:()=>n,get:()=>r,head:()=>d,patch:()=>t,post:()=>g,put:()=>a});var h=l(91749),m=l.n(h),E=l(33530),b=l.n(E);const o=config.relative_path+"/api/v3";async function s(e,i){if(e.url=e.url.startsWith("/api")?config.relative_path+e.url:o+e.url,typeof i=="function"){f(e).then(c=>i(null,c),c=>i(c));return}try{return await f(e)}catch(c){if(c.message==="A valid login session was not found. Please log in and try again."){const{url:u}=await(0,h.fire)("filter:admin.reauth",{url:"login"});return(0,E.confirm)("[[error:api.reauth-required]]",k=>{k&&ajaxify.go(u)})}throw c}}async function f(e){const{url:i}=e;delete e.url,e.data&&!(e.data instanceof FormData)&&(e.data=JSON.stringify(e.data||{}),e.headers["content-type"]="application/json; charset=utf-8"),{options:e}=await(0,h.fire)("filter:api.options",{options:e}),e.data&&(e.body=e.data,delete e.data);const c=await fetch(i,e),{headers:u}=c;if(u.get("x-redirect"))return f({url:u.get("x-redirect"),...e});const k=u.get("content-type"),v=k&&k.startsWith("application/json");let p;if(e.method!=="HEAD"&&(v?p=await c.json():p=await c.text()),!c.ok)throw p?new Error(v?p.status.message:p):new Error(c.statusText);return v&&p&&p.hasOwnProperty("status")&&p.hasOwnProperty("response")?p.response:p}function r(e,i,c){return s({url:e+(i&&Object.keys(i).length?"?"+$.param(i):"")},c)}function d(e,i,c){return s({url:e+(i&&Object.keys(i).length?"?"+$.param(i):""),method:"HEAD"},c)}function g(e,i,c){return s({url:e,method:"POST",data:i,headers:{"x-csrf-token":config.csrf_token}},c)}function t(e,i,c){return s({url:e,method:"PATCH",data:i,headers:{"x-csrf-token":config.csrf_token}},c)}function a(e,i,c){return s({url:e,method:"PUT",data:i,headers:{"x-csrf-token":config.csrf_token}},c)}function n(e,i,c){return s({url:e,method:"DELETE",data:i,headers:{"x-csrf-token":config.csrf_token}},c)}}),65348:((y,C,l)=>{"use strict";var h,m;h=[l(96349),l(33530),l(91749),l(17459)],m=(function(E,b,o,s){const f={};return f.init=function(r,d){if(!r||!r.length)return;d=d||{};const g=d.onSelect||function(){};d.states=d.states||["watching","tracking","notwatching","ignoring"],d.template=d.template||"partials/category/selector-dropdown-left",o.fire("action:category.selector.options",{el:r,options:d}),E.init(r,d);const t={el:r,selectedCategory:null};r.on("click","[data-cid]",function(){const n=$(this);return n.hasClass("disabled")?!1:(t.selectCategory(n.attr("data-cid")),g(t.selectedCategory))});let a=t.el.find('[component="category-selector-selected"]').html();return s.translate(a,n=>{a=n}),t.selectCategory=function(n){const e=t.el.find('[data-cid="'+n+'"]');t.selectedCategory={cid:n,name:e.attr("data-name")},e.length?t.el.find('[component="category-selector-selected"]').html(e.find('[component="category-markup"]').html()):t.el.find('[component="category-selector-selected"]').html(a)},t.getSelectedCategory=function(){return t.selectedCategory},t.getSelectedCid=function(){return t.selectedCategory?t.selectedCategory.cid:0},d.hasOwnProperty("selectedCategory")&&app.parseAndTranslate(d.template,{selectedCategory:d.selectedCategory},function(n){t.el.find('[component="category-selector-selected"]').html(n.find('[component="category-selector-selected"]').html())}),t},f.modal=function(r){r=r||{},r.onSelect=r.onSelect||function(){},r.onSubmit=r.onSubmit||function(){},app.parseAndTranslate("admin/partials/categories/select-category",{message:r.message},function(d){const g=b.dialog({title:r.title||"[[modules:composer.select-category]]",message:d,buttons:{save:{label:"[[global:select]]",className:"btn-primary",callback:a}}}),t=f.init(g.find('[component="category-selector"]'),r);function a(n){return n.preventDefault(),t.selectedCategory&&(r.onSubmit(t.selectedCategory),g.modal("hide")),!1}r.openOnLoad&&g.on("shown.bs.modal",function(){g.find(".dropdown-toggle").dropdown("toggle")}),g.find("form").on("submit",a)})},f}).apply(C,h),m!==void 0&&(y.exports=m)}),96349:((y,C,l)=>{"use strict";var h,m;h=[l(29930),l(89336),l(49897)],m=(function(E,b,o){const s={};return s.init=function(f,r){let d=r.defaultCategories||null;r=r||{},r.privilege=r.privilege||"topics:read",r.states=r.states||["watching","tracking","notwatching","ignoring"],r.cacheList=r.hasOwnProperty("cacheList")?r.cacheList:!0;let g=[];Array.isArray(r.localCategories)&&(g=r.localCategories.map(i=>({...i})),d&&(d=[...g,...d])),r.selectedCids=r.selectedCids||ajaxify.data.selectedCids||[];const t=f.find('[component="category-selector-search"]');if(!t.length)return;const a=t.parents('[component="category/dropdown"]').length>0||t.parents('[component="category-selector"]').length>0;f.on("show.bs.dropdown",function(){a&&t.removeClass("hidden");function i(){const c=t.find("input").val();c.length>1||!c&&!d?n(c,function(u){d=r.cacheList&&(d||u),e(u)}):!c&&d&&e(d)}t.on("click",function(c){c.preventDefault(),c.stopPropagation()}),t.find("input").val("").on("keyup",utils.debounce(i,300)),i()}),f.on("shown.bs.dropdown",function(){["xs","sm"].includes(utils.findBootstrapEnvironment())||t.find("input").focus()}),f.on("hide.bs.dropdown",function(){a&&t.addClass("hidden"),t.off("click"),t.find("input").off("keyup")});function n(i,c){o.get("/search/categories",{search:i,query:utils.params(),parentCid:r.parentCid||0,selectedCids:r.selectedCids,privilege:r.privilege,states:r.states,showLinks:r.showLinks},function(u,{categories:k}){if(u)return E.error(u);c(g.concat(k))})}function e(i){const c=r.selectedCids.map(String);i.forEach(function(u){u.selected=c.includes(String(u.cid))}),app.parseAndTranslate(r.template,{categoryItems:i.slice(0,200),selectedCategory:ajaxify.data.selectedCategory,allCategoriesUrl:ajaxify.data.allCategoriesUrl},function(u){f.find('[component="category/list"]').html(u.find('[component="category/list"]').html()),f.find('[component="category/list"] [component="category/no-matches"]').toggleClass("hidden",!!i.length);const k=b.Dropdown.getInstance(f.find(".dropdown-toggle").get(0));k&&k.update()})}},s}).apply(C,h),m!==void 0&&(y.exports=m)})}]);
