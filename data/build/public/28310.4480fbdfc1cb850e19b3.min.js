"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[28310],{28310:((y,h,s)=>{var u,d;u=[s(65348),s(29930),s(91749),s(49897)],d=(function(C,g,v,p){const n={};let e,o;n.init=function(c,i,a){e||(n.tids=c,n.currentCid=i,n.onComplete=a,n.moveAll=!c,r())};function r(){app.parseAndTranslate("modals/move-topic",{},function(c){e=c,$("body").append(e),(n.moveAll||n.tids&&n.tids.length>1)&&e.find(".card-header").translateText("[[topic:move-topics]]");const i=e.find('[component="category-selector"]');i.addClass("dropup"),C.init(i,{onSelect:t,privilege:"moderate"}),e.find("#move_thread_commit").on("click",f),e.find("#move_topic_cancel").on("click",m)})}function t(c){o=c,e.find("#move_thread_commit").prop("disabled",!1)}function f(){const c=e.find("#move_thread_commit");if(!c.prop("disabled")&&o&&o.cid){c.prop("disabled",!0),m();let i="[[topic:topic-move-success, "+o.name+"]]";n.tids&&n.tids.length>1?i="[[topic:topic-move-multiple-success, "+o.name+"]]":n.tids||(i="[[topic:topic-move-all-success, "+o.name+"]]");const a={tids:n.tids?n.tids.slice():null,cid:o.cid,currentCid:n.currentCid,onComplete:n.onComplete};if(config.undoTimeout>0)return g.alert({alert_id:"tids_move_"+(n.tids?n.tids.join("-"):"all"),title:"[[topic:thread-tools.move]]",message:i,type:"success",timeout:config.undoTimeout,timeoutfn:function(){l(a)},clickfn:function(E,A){delete A.timeoutfn,g.success("[[topic:topic-move-undone]]")}});l(a)}}function l(c){v.fire("action:topic.move",c),c.tids?c.tids.forEach(i=>{p.put(`/topics/${i}/move`,{cid:c.cid}).then(()=>{typeof c.onComplete=="function"&&c.onComplete()}).catch(g.error)}):socket.emit("topics.moveAll",c,function(i){if(i)return g.error(i);typeof c.onComplete=="function"&&c.onComplete()})}function m(){e&&(e.remove(),e=null)}return n}).apply(h,u),d!==void 0&&(y.exports=d)}),65348:((y,h,s)=>{var u,d;u=[s(96349),s(33530),s(91749),s(17459)],d=(function(C,g,v,p){const n={};return n.init=function(e,o){if(!e||!e.length)return;o=o||{};const r=o.onSelect||function(){};o.states=o.states||["watching","tracking","notwatching","ignoring"],o.template=o.template||"partials/category/selector-dropdown-left",v.fire("action:category.selector.options",{el:e,options:o}),C.init(e,o);const t={el:e,selectedCategory:null};e.on("click","[data-cid]",function(){const l=$(this);return l.hasClass("disabled")?!1:(t.selectCategory(l.attr("data-cid")),r(t.selectedCategory))});let f=t.el.find('[component="category-selector-selected"]').html();return p.translate(f,l=>{f=l}),t.selectCategory=function(l){const m=t.el.find('[data-cid="'+l+'"]');t.selectedCategory={cid:l,name:m.attr("data-name")},m.length?t.el.find('[component="category-selector-selected"]').html(m.find('[component="category-markup"]').html()):t.el.find('[component="category-selector-selected"]').html(f)},t.getSelectedCategory=function(){return t.selectedCategory},t.getSelectedCid=function(){return t.selectedCategory?t.selectedCategory.cid:0},o.hasOwnProperty("selectedCategory")&&app.parseAndTranslate(o.template,{selectedCategory:o.selectedCategory},function(l){t.el.find('[component="category-selector-selected"]').html(l.find('[component="category-selector-selected"]').html())}),t},n.modal=function(e){e=e||{},e.onSelect=e.onSelect||function(){},e.onSubmit=e.onSubmit||function(){},app.parseAndTranslate("admin/partials/categories/select-category",{message:e.message},function(o){const r=g.dialog({title:e.title||"[[modules:composer.select-category]]",message:o,buttons:{save:{label:"[[global:select]]",className:"btn-primary",callback:f}}}),t=n.init(r.find('[component="category-selector"]'),e);function f(l){return l.preventDefault(),t.selectedCategory&&(e.onSubmit(t.selectedCategory),r.modal("hide")),!1}e.openOnLoad&&r.on("shown.bs.modal",function(){r.find(".dropdown-toggle").dropdown("toggle")}),r.find("form").on("submit",f)})},n}).apply(h,u),d!==void 0&&(y.exports=d)}),96349:((y,h,s)=>{var u,d;u=[s(29930),s(89336),s(49897)],d=(function(C,g,v){const p={};return p.init=function(n,e){let o=e.defaultCategories||null;e=e||{},e.privilege=e.privilege||"topics:read",e.states=e.states||["watching","tracking","notwatching","ignoring"],e.cacheList=e.hasOwnProperty("cacheList")?e.cacheList:!0;let r=[];Array.isArray(e.localCategories)&&(r=e.localCategories.map(c=>({...c})),o&&(o=[...r,...o])),e.selectedCids=e.selectedCids||ajaxify.data.selectedCids||[];const t=n.find('[component="category-selector-search"]');if(!t.length)return;const f=t.parents('[component="category/dropdown"]').length>0||t.parents('[component="category-selector"]').length>0;n.on("show.bs.dropdown",function(){f&&t.removeClass("hidden");function c(){const i=t.find("input").val();i.length>1||!i&&!o?l(i,function(a){o=e.cacheList&&(o||a),m(a)}):!i&&o&&m(o)}t.on("click",function(i){i.preventDefault(),i.stopPropagation()}),t.find("input").val("").on("keyup",utils.debounce(c,300)),c()}),n.on("shown.bs.dropdown",function(){["xs","sm"].includes(utils.findBootstrapEnvironment())||t.find("input").focus()}),n.on("hide.bs.dropdown",function(){f&&t.addClass("hidden"),t.off("click"),t.find("input").off("keyup")});function l(c,i){v.get("/search/categories",{search:c,query:utils.params(),parentCid:e.parentCid||0,selectedCids:e.selectedCids,privilege:e.privilege,states:e.states,showLinks:e.showLinks},function(a,{categories:E}){if(a)return C.error(a);i(r.concat(E))})}function m(c){const i=e.selectedCids.map(String);c.forEach(function(a){a.selected=i.includes(String(a.cid))}),app.parseAndTranslate(e.template,{categoryItems:c.slice(0,200),selectedCategory:ajaxify.data.selectedCategory,allCategoriesUrl:ajaxify.data.allCategoriesUrl},function(a){n.find('[component="category/list"]').html(a.find('[component="category/list"]').html()),n.find('[component="category/list"] [component="category/no-matches"]').toggleClass("hidden",!!c.length);const E=g.Dropdown.getInstance(n.find(".dropdown-toggle").get(0));E&&E.update()})}},p}).apply(h,u),d!==void 0&&(y.exports=d)})}]);
